<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Концепт 2: Оптимизированный</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <style>
    /* Минималистичные стили, остальное в Tailwind */
    .glass-effect {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(16px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      transition: background 0.3s, border-color 0.3s;
    }
    .dark .glass-effect {
      background: rgba(30, 30, 30, 0.9);
      border-color: rgba(75, 85, 99, 0.3);
    }
    
    /* Убираем стандартный маркер details */
    details > summary { list-style: none; }
    details > summary::-webkit-details-marker { display: none; }
    
    /* Анимации входа */
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    .animate-fade-in { animation: fadeIn 0.3s ease-out; }
    .animate-slide-up { animation: slideUp 0.5s ease-out; }
    
    @keyframes shimmer { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }
    .animate-shimmer { animation: shimmer 2s infinite; }
  </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 min-h-screen flex items-center justify-center p-4 transition-colors duration-300">

  <!-- Theme Toggle -->
  <button id="theme-toggle" class="fixed top-4 right-4 z-50 p-3 bg-white dark:bg-gray-800 rounded-full shadow-lg hover:scale-110 transition-all border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-300">
    <!-- Иконка Солнца (скрыта в темной теме) -->
    <svg class="w-5 h-5 dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>
    <!-- Иконка Луны (скрыта в светлой теме) -->
    <svg class="w-5 h-5 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>
  </button>

  <div class="fixed inset-0 bg-black/40 dark:bg-black/60 backdrop-blur-sm animate-fade-in z-50 transition-colors duration-300"></div>
  
  <div class="glass-effect rounded-xl p-5 shadow-2xl w-full mx-4 animate-slide-up relative z-50 max-w-[336px]">
    <!-- Header -->
    <div class="flex items-center justify-between mb-4">
      <div class="flex items-center gap-2">
        <span class="text-xs text-gray-500 dark:text-gray-400">v1.3.0</span>
        <span class="text-xs text-gray-500 dark:text-gray-400">→</span>
        <div class="px-2 py-0.5 bg-blue-500/20 dark:bg-blue-500/30 rounded-full border border-blue-500/30">
          <span class="text-xs font-semibold text-blue-600 dark:text-blue-400">v1.4.0</span>
        </div>
      </div>
      <div class="text-right">
        <div class="text-xl font-bold text-gray-900 dark:text-white" id="countdown-display">10</div>
        <div class="text-[10px] text-gray-500 dark:text-gray-400">сек</div>
      </div>
    </div>

    <div class="text-center mb-4">
      <h2 class="text-xl font-bold text-gray-900 dark:text-white mb-1">Доступно обновление</h2>
      <p class="text-xs text-gray-600 dark:text-gray-400">Рекомендуем обновиться для новых возможностей</p>
    </div>

    <!-- Progress Bar -->
    <div class="mb-4">
      <div class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden flex">
        <div class="h-full rounded-full transition-all duration-1000 relative overflow-hidden ml-auto" id="progress-bar" style="width: 100%;">
          <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-shimmer"></div>
        </div>
      </div>
      <div class="text-center mt-1.5 text-[10px] text-gray-500 dark:text-gray-400">
        Автообновление через <span id="countdown-text">10</span> сек
      </div>
    </div>

    <!-- Accordion -->
    <details class="mb-4 group overflow-hidden">
      <summary class="cursor-pointer text-sm font-semibold text-gray-900 dark:text-white mb-2 hover:text-blue-600 dark:hover:text-blue-400 transition-colors flex items-center gap-1.5 select-none">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>
        Что нового? (5 изменений)
        <svg id="arrow-icon" class="w-3 h-3 ml-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
      </summary>
      
      <div class="changelog-content space-y-2 overflow-hidden h-0 opacity-0">
        <!-- Content Items -->
        <div class="p-2.5 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800">
          <div class="flex items-center gap-1.5 mb-1.5">
            <svg class="w-4 h-4 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>
            <span class="text-xs font-semibold text-green-700 dark:text-green-400">Новые возможности</span>
          </div>
          <ul class="space-y-0.5 text-xs text-gray-700 dark:text-gray-300 ml-5.5">
            <li>• Экспорт данных в Excel формат</li>
            <li>• Новые темы оформления</li>
          </ul>
        </div>

        <div class="p-2.5 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800">
          <div class="flex items-center gap-1.5 mb-1.5">
            <svg class="w-4 h-4 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>
            <span class="text-xs font-semibold text-blue-700 dark:text-blue-400">Улучшения</span>
          </div>
          <ul class="space-y-0.5 text-xs text-gray-700 dark:text-gray-300 ml-5.5">
            <li>• Оптимизирована производительность</li>
            <li>• Улучшен интерфейс импорта</li>
          </ul>
        </div>

        <div class="p-2.5 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800">
          <div class="flex items-center gap-1.5 mb-1.5">
            <svg class="w-4 h-4 text-yellow-600 dark:text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
            <span class="text-xs font-semibold text-yellow-700 dark:text-yellow-400">Исправления</span>
          </div>
          <ul class="space-y-0.5 text-xs text-gray-700 dark:text-gray-300 ml-5.5">
            <li>• Исправлены ошибки импорта JSON</li>
          </ul>
        </div>
      </div>
    </details>

    <div class="flex gap-2">
      <button class="flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg shadow-lg transition-colors">Обновить сейчас</button>
      <button class="flex-1 px-3 py-2 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 text-sm font-medium rounded-lg transition-colors">Позже</button>
    </div>
  </div>

  <script>
    // 1. Темизация
    const themeBtn = document.getElementById('theme-toggle');
    const initTheme = () => {
      const isDark = localStorage.getItem('theme') !== 'light'; // Default to dark
      document.documentElement.classList.toggle('dark', isDark);
    };
    themeBtn.onclick = () => {
      const isDark = document.documentElement.classList.toggle('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    };
    initTheme();

    // 2. Таймер
    let countdown = 10;
    let isPaused = false;
    const els = {
      display: document.getElementById('countdown-display'),
      text: document.getElementById('countdown-text'),
      bar: document.getElementById('progress-bar')
    };
    
    // Функция цвета (Синий -> Желтый -> Красный)
    const getColor = (p) => {
      if (p < 50) { // Синий -> Желтый
        const r = p/50;
        return `rgb(${59 + (196 * r)}, ${130 + (63 * r)}, ${246 - (239 * r)})`;
      } 
      // Желтый -> Красный
      const r = (p - 50)/50;
      return `rgb(${255 - (16 * r)}, ${193 - (125 * r)}, ${7 + (61 * r)})`;
    };

    const timer = setInterval(() => {
      if (isPaused || countdown <= 0) {
        if (countdown <= 0) clearInterval(timer);
        return;
      }
      countdown--;
      els.display.textContent = els.text.textContent = countdown;
      
      const progress = ((10 - countdown) / 10) * 100;
      els.bar.style.width = `${100 - progress}%`;
      els.bar.style.background = getColor(100 - progress);
    }, 1000);

    // Пауза при наведении
    const modal = document.querySelector('.glass-effect');
    modal.onmouseenter = () => isPaused = true;
    modal.onmouseleave = () => isPaused = false;

    // 3. Анимация Details (Оптимизированная)
    document.querySelectorAll('details').forEach(detail => {
      const summary = detail.querySelector('summary');
      const content = detail.querySelector('.changelog-content');
      const arrow = summary.querySelector('#arrow-icon');

      summary.addEventListener('click', (e) => {
        e.preventDefault(); // Останавливаем нативное переключение
        
        // Если уже открыт - закрываем
        if (detail.hasAttribute('open')) {
          gsap.to(arrow, { rotation: 0, duration: 0.3 });
          gsap.to(content, {
            height: 0, opacity: 0, duration: 0.3, ease: 'power2.in',
            onComplete: () => detail.removeAttribute('open')
          });
          // Анимация карточек назад
          gsap.to(content.children, { y: 20, opacity: 0, duration: 0.2, stagger: -0.05 });
        } else {
          // Открываем
          detail.setAttribute('open', '');
          gsap.to(arrow, { rotation: 180, duration: 0.3 });
          
          // Анимация контента
          gsap.fromTo(content, 
            { height: 0, opacity: 0 },
            { height: 'auto', opacity: 1, duration: 0.4, ease: 'power2.out' }
          );
          
          // Анимация карточек (Stagger)
          gsap.fromTo(content.children,
            { y: 20, opacity: 0 },
            { y: 0, opacity: 1, duration: 0.4, stagger: 0.08, delay: 0.1 }
          );
        }
      });
    });
  </script>
</body>
</html>